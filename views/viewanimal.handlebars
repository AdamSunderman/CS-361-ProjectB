<link rel="stylesheet" type= "text/css" href="/stylesheets/viewanimal.css"/>

<div id="mainContainer">
<div id="photo"></div>	
<div id="description"></div>
<div id="city"></div>
<div id="state"></div>
<div id="address"></div>
<div id="status"></div>
<div>
<input type="submit" name="helpSubmit" id="helpSubmit" value = "Help">
<input type="submit" name="hostSubmit" id="hostSubmit" value = "Host">
<input type="submit" name="adoptSubmit" id="adoptSubmit" value = "Adopt">
</div>
</div>

<div id="currenthost"></div>>

<script type = "text/javascript">

function getParameterByName(name, url) {
    if (!url) {
      url = window.location.href;
    }
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

document.getElementById("description").innerHTML = getParameterByName("description");
document.getElementById("city").innerHTML = getParameterByName("city") + ", " + getParameterByName("animalState");
document.getElementById("address").innerHTML = getParameterByName("address");
document.getElementById("status").innerHTML = getParameterByName("status");

//BUTTONS NOT HOOKED UP
document.getElementById('helpSubmit').addEventListener('click', function(event){
	var req = new XMLHttpRequest();
	var payload = {};
	payload.animalID = getParameterByName("anId").value;
	req.open('POST', '/helpanimal', true);
	req.setRequestHeader('Content-Type', 'application/json');
	req.addEventListener('load',function(){
		if(req.status >= 200 && req.status < 400){

			console.log("The response text: ");
			console.log(req.responseText);
			var resData = JSON.parse(req.response);
			document.getElementById('currenthost').innerHTML =resData;
			console.log(resData);
		}	
		else{
			console.log("Error in network request: " + req.statusText);
		}
	});

	req.send(JSON.stringify(payload);
	event.preventDefault();
	event.stopPropagation();
});


document.getElementById('hostSubmit').addEventListener('click', function(event){
	var req = new XMLHttpRequest();
	var payload = {};
	payload.animalID = getParameterByName("anId").value;
	payload.uname = getParameterByName("uname").value;
	payload.pw = getParameterByName("upass").value;
	req.open('POST', '/hostanimal', true);
	req.setRequestHeader('Content-Type', 'application/json');
	req.addEventListener('load',function(){
		if(req.status >= 200 && req.status < 400){
			console.log("The response text: ");
			console.log(req.responseText);
			var resData = JSON.parse(req.response);
			console.log(resData);
			document.getElementById('currenthost').innerHTML =resData;
			
		}	
		else{
			console.log("Error in network request: " + req.statusText);
		}
	});

	req.send(JSON.stringify(payload));
	event.preventDefault();
	event.stopPropagation();
});

document.getElementById('adoptSubmit').addEventListener('click', function(event){
	var req = new XMLHttpRequest();
	var payload = {};
	payload.animalID = getParameterByName("anId").value;
	payload.uname = getParameterByName("uname").value;
	payload.pw = getParameterByName("upass").value;
	req.open('POST', '/adoptanimal', true);
	req.setRequestHeader('Content-Type', 'application/json');
	req.addEventListener('load',function(){
		if(req.status >= 200 && req.status < 400){
			console.log("The response text: ");
			console.log(req.responseText);
			var resData = JSON.parse(req.response);
			console.log(resData);
			document.getElementById('currenthost').innerHTML =resData;
		}	
		else{
			console.log("Error in network request: " + req.statusText);
		}
	});
	req.send(JSON.stringify(payload));
	event.preventDefault();
	event.stopPropagation();
});

</script>
